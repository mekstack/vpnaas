apiVersion: apps/v1
kind: Deployment
metadata:
  name: confus
  namespace: vpnaas
spec:
  replicas: 1
  selector:
    matchLabels:
      app: confus
  template:
    metadata:
      labels:
        app: confus
    spec:
      containers:
      - name: confus
        image: mekstack/confus:latest
        imagePullPolicy: Never
        ports:
        - containerPort: 80
        env:
        - name: RUST_LOG
          value: info
        - name: VPNAAS_CONFIG_ENDPOINT
          value: wg.mekstack.ru
        - name: VPNAAS_CONFIG_PUBKEY
          value: mZjqLnMXtQUpPLu1ntq2PgrG75HDarhvywvmT7M9gQo
        - name: VPNAAS_CONFIG_ALLOWED_IPS
          value: 0.0.0.0/0
        - name: VPNAAS_CONFIG_DNS
          value: 8.8.8.8
---
apiVersion: v1
kind: Service
metadata:
  name: confus
  namespace: vpnaas
spec:
  selector:
    app: confus
  ports:
  - protocol: TCP
    port: 80
